<?php
/**
 * File SqlPentester.php
 *
 * PHP Version 5.6
 *
 * @category  Class
 * @package   Package zerowing
 * @author    mrgn <xyz@example.com>
 * @copyright 2016 mrgn
 * @license   MIT http://choosealicense.com/licenses/mit/
 * @link      http://lorem.ovh
 */

namespace AppBundle\Utils\Pentester;

use AppBundle\Utils\Reporter\Reporter;

class SqlPentester
{
    /** @var  Reporter */
    private $reporter;

    public function __construct()
    {
        $this->reporter = new Reporter("sqli");
    }

    /**
     * launches the full pentest process
     * @return string the report
     */
    public function doAllTests()
    {
        $this->sqlErrorInjection();

        return $this->getReport();
    }

    public function report($msg)
    {
        $this->reporter->report($msg);
    }

    public function getReport()
    {
        // TODO: Implement getReport() method.
        return $this->reporter->getReports();
    }

    public function sqlErrorInjection()
    {
        if ( rand(0,1) > 0.5 )
        {
            $this->report("we did it ");
        } else {
            $this->report("nope sorry");
        }
    }

}