<?php
/**
 * File SqlPentesterTest.php
 *
 * PHP Version 5.6
 *
 * @category  Test
 * @package   AppBundle\Tests\Utils\Pentester
 * @author    mrgn <xyz@example.com>
 * @copyright 2016 mrgn
 * @license   MIT http://choosealicense.com/licenses/mit/
 * @link      http://lorem.ovh
 */

namespace AppBundle\Tests\Utils\Pentester;

namespace AppBundle\Tests\Controller;

use Guzzle\Http\Client;
use Guzzle\Plugin\Cookie\CookieJar\ArrayCookieJar;
use Guzzle\Plugin\Cookie\CookiePlugin;

class SqlPentesterTest extends AbstractPentesterTest
{

    /**
     * Test the DVWA access setup (to be sure __construct worked well)
     */
    public function testDvwaAccessAction()
    {
        $guzzle = $this->getDvwaGuzzle();
        $dvwa_url = $this->getDVWAURL();

        $this->assertNotNull($guzzle, "guzzle client Y U NO set up?");

        $uri = 'index.php';
        $res = $guzzle->get($uri)->send();

        $this->assertEquals(200, $res->getStatusCode(), "is the serv online ? URL defined ?");
        $this->assertEquals($dvwa_url.$uri, $res->getEffectiveUrl(), "maybe not authed :/");
    }
}
