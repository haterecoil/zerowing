<?php
/**
 * File FuzzPentesterTest.php
 *
 * PHP Version 5.6
 *
 * @category  Test
 * @package   AppBundle\Tests\Utils\Pentester
 * @author    mrgn <xyz@example.com>
 * @copyright 2016 mrgn
 * @license   MIT http://choosealicense.com/licenses/mit/
 * @link      http://lorem.ovh
 */

namespace AppBundle\Tests\Utils\Pentester;

namespace AppBundle\Tests\Controller;

use AppBundle\Utils\Pentester\FuzzPentester;
use AppBundle\Utils\Target\SqlTarget;
use Doctrine\ORM\EntityManager;
use Misd\GuzzleBundle\MisdGuzzleBundle;
use Symfony\Bundle\FrameworkBundle\Tests\Functional\WebTestCase;

class FuzzPentesterTest extends WebTestCase
{

    /**
     * @var EntityManager
     */
    private $_em;

    public function setUp()
    {
        self::bootKernel();
        $this->_em = static::$kernel->getContainer()
            ->get('doctrine')
            ->getManager();
    }

    public function testFuzzCommonUrls()
    {
        $target = new SqlTarget("GET", "http://swarm.ovh");
        $guzzle = new MisdGuzzleBundle();


        $fuzzPentester = new FuzzPentester($guzzle,$this->_em);

        $report = $fuzzPentester->fuzzCommonUrls($target);

        dump($report);
    }
}
